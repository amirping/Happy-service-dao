const User=require("../models/user").User,Connection=require("../models/connection").Connection;module.exports={isTokenUp:function(e,n){let o=e.body.token,s=e.body.date;Connection.findOne({session_token:o},function(e,t){if(e)throw console.log(e),e;if(null!=t){let e=t.id_user;Connection.find({id_user:e}).sort({create_date:-1}).exec(function(e,t){if(e)throw console.log(e),e;let i=new Date(s),c=new Date(t[0].create_date.toString());i.setSeconds(0),i.setMilliseconds(0),c.setSeconds(0),c.setMilliseconds(0),null!=t[0]&&i.getTime()===c.getTime()&&o===t[0].session_token?n.status(200).json({isToeknUp:!0}):n.status(200).json({isToeknUp:!1})})}else n.status(200).json({isToeknUp:!1})})}};